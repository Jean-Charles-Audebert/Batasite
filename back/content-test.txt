
> back@1.0.0 test
> jest --forceExit content.controller.test.js

  console.log
    [dotenv@17.2.3] injecting env (16) from .env -- tip: Ã”ÃœÃ–Â´Â©Ã…  override existing env vars with { override: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: Â­Æ’Ã´Ã­ add observability to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Database config: {
      user: 'batadmin',
      host: 'localhost',
      port: 5434,
      database: 'batasite'
    }

      at Object.log (src/config/db.js:12:9)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: Â­Æ’Ã¹Ã©Â´Â©Ã… backup and recover secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Query executed: {
      queryText: 'INSERT INTO admins (email, password_hash, role) VALUES ($1, $2, $3) RETURNING id',
      duration: 24,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'INSERT INTO content (content, updated_by) VALUES ($1, $2)',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'SELECT id, content, updated_at FROM content ORDER BY id DESC LIMIT 1',
      duration: 3,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content retrieved by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: { queryText: 'DELETE FROM content', duration: 2, rows: 1 }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'SELECT id, content, updated_at FROM content ORDER BY id DESC LIMIT 1',
      duration: 1,
      rows: 0
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'INSERT INTO content (content) VALUES ($1) RETURNING id, content, updated_at',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content retrieved by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: { queryText: 'DELETE FROM content', duration: 2, rows: 1 }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'INSERT INTO content (content, updated_by) VALUES ($1, $2)',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'SELECT id, content, updated_at FROM content ORDER BY id DESC LIMIT 1',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content retrieved by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: {
      queryText: 'SELECT id FROM content ORDER BY id DESC LIMIT 1',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'UPDATE content SET content = $1, updated_at = CURRENT_TIMESTAMP, updated_by = $2 WHERE id = $3 RETURNING id, content, updated_at, updated_by',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content updated by admin: 61

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Content updated by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: {
      queryText: 'SELECT id FROM content ORDER BY id DESC LIMIT 1',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'UPDATE content SET content = $1, updated_at = CURRENT_TIMESTAMP, updated_by = $2 WHERE id = $3 RETURNING id, content, updated_at, updated_by',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content updated by admin: 61

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Content updated by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: {
      queryText: 'SELECT id FROM content ORDER BY id DESC LIMIT 1',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'UPDATE content SET content = $1, updated_at = CURRENT_TIMESTAMP, updated_by = $2 WHERE id = $3 RETURNING id, content, updated_at, updated_by',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content updated by admin: 61

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Content updated by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: {
      queryText: 'SELECT id FROM content ORDER BY id DESC LIMIT 1',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'UPDATE content SET content = $1, updated_at = CURRENT_TIMESTAMP, updated_by = $2 WHERE id = $3 RETURNING id, content, updated_at, updated_by',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content updated by admin: 61

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Content updated by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.error
    Error: Error: "data" must be of type object
        at updateContent (C:\Workspaces\Perso\Batasite\back\src\controllers\content.controller.js:36:19)
        at Layer.handleRequest (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\layer.js:152:17)
        at next (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\route.js:157:13)
        at Route.dispatch (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\route.js:117:3)
        at handle (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:435:11)
        at Layer.handleRequest (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\layer.js:152:17)
        at C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:295:15
        at processParams (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:582:12)
        at next (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:291:5)
        at next (C:\Workspaces\Perso\Batasite\back\src\middleware\auth.js:22:3)
        at Layer.handleRequest (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\layer.js:152:17)
        at trimPrefix (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:342:13)
        at C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:297:9
        at processParams (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:582:12)
        at next (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:291:5)
        at router.handle (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:186:3)
        at router (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:60:12)
        at Layer.handleRequest (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\layer.js:152:17)
        at trimPrefix (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:342:13)
        at C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:297:9
        at processParams (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:582:12)
        at next (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:291:5)
        at next (C:\Workspaces\Perso\Batasite\back\src\server.js:20:3)
        at Layer.handleRequest (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\layer.js:152:17)
        at trimPrefix (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:342:13)
        at C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:297:9
        at processParams (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:582:12)
        at next (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:291:5)
        at read (C:\Workspaces\Perso\Batasite\back\node_modules\body-parser\lib\read.js:43:5)
        at urlencodedParser (C:\Workspaces\Perso\Batasite\back\node_modules\body-parser\lib\types\urlencoded.js:58:5)
        at Layer.handleRequest (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\layer.js:152:17)
        at trimPrefix (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:342:13)
        at C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:297:9
        at processParams (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:582:12)
        at next (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:291:5)
        at C:\Workspaces\Perso\Batasite\back\node_modules\body-parser\lib\read.js:172:5
        at AsyncResource.runInAsyncScope (node:async_hooks:214:14)
        at invokeCallback (C:\Workspaces\Perso\Batasite\back\node_modules\raw-body\index.js:238:16)
        at done (C:\Workspaces\Perso\Batasite\back\node_modules\raw-body\index.js:227:7)
        at IncomingMessage.onEnd (C:\Workspaces\Perso\Batasite\back\node_modules\raw-body\index.js:287:7)
        at IncomingMessage.emit (node:events:508:28)
        at endReadableNT (node:internal/streams/readable:1701:12)
        at processTicksAndRejections (node:internal/process/task_queues:90:21) {
      status: 400
    }

    [0m [90m 38 |[39m [90m// Error handler[39m
     [90m 39 |[39m app[33m.[39muse((err[33m,[39m req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 40 |[39m   console[33m.[39merror([32m'Error:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 41 |[39m   res[33m.[39mstatus(err[33m.[39mstatus [33m||[39m [35m500[39m)[33m.[39mjson({
     [90m 42 |[39m     error[33m:[39m err[33m.[39mmessage [33m||[39m [32m'Internal Server Error'[39m[33m,[39m
     [90m 43 |[39m     [33m...[39m(process[33m.[39menv[33m.[39m[33mNODE_ENV[39m [33m===[39m [32m'development'[39m [33m&&[39m { stack[33m:[39m err[33m.[39mstack })[33m,[39m[0m

      at error (src/server.js:40:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at next (src/controllers/content.controller.js:38:14)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (src/middleware/auth.js:22:3)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at router.handle (node_modules/router/index.js:186:3)
      at router (node_modules/router/index.js:60:12)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (src/server.js:20:3)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at read (node_modules/body-parser/lib/read.js:43:5)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:58:5)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/body-parser/lib/read.js:172:5
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

  console.log
    Query executed: {
      queryText: 'SELECT id FROM content ORDER BY id DESC LIMIT 1',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'UPDATE content SET content = $1, updated_at = CURRENT_TIMESTAMP, updated_by = $2 WHERE id = $3 RETURNING id, content, updated_at, updated_by',
      duration: 3,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content updated by admin: 61

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Content updated by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: { queryText: 'DELETE FROM content', duration: 2, rows: 1 }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'INSERT INTO content (content, updated_by) VALUES ($1, $2)',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'SELECT id, content, updated_at FROM content ORDER BY id DESC LIMIT 1',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'SELECT id FROM content ORDER BY id DESC LIMIT 1',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'UPDATE content SET content = $1, updated_at = CURRENT_TIMESTAMP, updated_by = $2 WHERE id = $3 RETURNING id, content, updated_at, updated_by',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content updated by admin: 61

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Content patched by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: { queryText: 'DELETE FROM content', duration: 2, rows: 1 }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'INSERT INTO content (content, updated_by) VALUES ($1, $2)',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'SELECT id, content, updated_at FROM content ORDER BY id DESC LIMIT 1',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'SELECT id FROM content ORDER BY id DESC LIMIT 1',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'UPDATE content SET content = $1, updated_at = CURRENT_TIMESTAMP, updated_by = $2 WHERE id = $3 RETURNING id, content, updated_at, updated_by',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content updated by admin: 61

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Content patched by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.error
    Error: Error: "data" must be of type object
        at patchContent (C:\Workspaces\Perso\Batasite\back\src\controllers\content.controller.js:63:19)
        at Layer.handleRequest (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\layer.js:152:17)
        at next (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\route.js:157:13)
        at Route.dispatch (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\route.js:117:3)
        at handle (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:435:11)
        at Layer.handleRequest (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\layer.js:152:17)
        at C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:295:15
        at processParams (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:582:12)
        at next (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:291:5)
        at next (C:\Workspaces\Perso\Batasite\back\src\middleware\auth.js:22:3)
        at Layer.handleRequest (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\layer.js:152:17)
        at trimPrefix (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:342:13)
        at C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:297:9
        at processParams (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:582:12)
        at next (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:291:5)
        at router.handle (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:186:3)
        at router (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:60:12)
        at Layer.handleRequest (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\layer.js:152:17)
        at trimPrefix (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:342:13)
        at C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:297:9
        at processParams (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:582:12)
        at next (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:291:5)
        at next (C:\Workspaces\Perso\Batasite\back\src\server.js:20:3)
        at Layer.handleRequest (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\layer.js:152:17)
        at trimPrefix (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:342:13)
        at C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:297:9
        at processParams (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:582:12)
        at next (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:291:5)
        at read (C:\Workspaces\Perso\Batasite\back\node_modules\body-parser\lib\read.js:43:5)
        at urlencodedParser (C:\Workspaces\Perso\Batasite\back\node_modules\body-parser\lib\types\urlencoded.js:58:5)
        at Layer.handleRequest (C:\Workspaces\Perso\Batasite\back\node_modules\router\lib\layer.js:152:17)
        at trimPrefix (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:342:13)
        at C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:297:9
        at processParams (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:582:12)
        at next (C:\Workspaces\Perso\Batasite\back\node_modules\router\index.js:291:5)
        at C:\Workspaces\Perso\Batasite\back\node_modules\body-parser\lib\read.js:172:5
        at AsyncResource.runInAsyncScope (node:async_hooks:214:14)
        at invokeCallback (C:\Workspaces\Perso\Batasite\back\node_modules\raw-body\index.js:238:16)
        at done (C:\Workspaces\Perso\Batasite\back\node_modules\raw-body\index.js:227:7)
        at IncomingMessage.onEnd (C:\Workspaces\Perso\Batasite\back\node_modules\raw-body\index.js:287:7)
        at IncomingMessage.emit (node:events:508:28)
        at endReadableNT (node:internal/streams/readable:1701:12)
        at processTicksAndRejections (node:internal/process/task_queues:90:21) {
      status: 400
    }

    [0m [90m 38 |[39m [90m// Error handler[39m
     [90m 39 |[39m app[33m.[39muse((err[33m,[39m req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 40 |[39m   console[33m.[39merror([32m'Error:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 41 |[39m   res[33m.[39mstatus(err[33m.[39mstatus [33m||[39m [35m500[39m)[33m.[39mjson({
     [90m 42 |[39m     error[33m:[39m err[33m.[39mmessage [33m||[39m [32m'Internal Server Error'[39m[33m,[39m
     [90m 43 |[39m     [33m...[39m(process[33m.[39menv[33m.[39m[33mNODE_ENV[39m [33m===[39m [32m'development'[39m [33m&&[39m { stack[33m:[39m err[33m.[39mstack })[33m,[39m[0m

      at error (src/server.js:40:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/router/index.js:688:15
      at next (node_modules/router/index.js:276:14)
      at next (node_modules/router/lib/route.js:132:14)
      at next (src/controllers/content.controller.js:65:14)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at next (node_modules/router/lib/route.js:157:13)
      at Route.dispatch (node_modules/router/lib/route.js:117:3)
      at handle (node_modules/router/index.js:435:11)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at node_modules/router/index.js:295:15
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (src/middleware/auth.js:22:3)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at router.handle (node_modules/router/index.js:186:3)
      at router (node_modules/router/index.js:60:12)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at next (src/server.js:20:3)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at read (node_modules/body-parser/lib/read.js:43:5)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:58:5)
      at Layer.handleRequest (node_modules/router/lib/layer.js:152:17)
      at trimPrefix (node_modules/router/index.js:342:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at node_modules/body-parser/lib/read.js:172:5
      at invokeCallback (node_modules/raw-body/index.js:238:16)
      at done (node_modules/raw-body/index.js:227:7)
      at IncomingMessage.onEnd (node_modules/raw-body/index.js:287:7)

  console.log
    Query executed: {
      queryText: 'SELECT c.id, c.content, c.updated_at, a.email \n' +
        '       FROM content c\n' +
        '       LEFT JOIN admins a ON c.updated_by = a.id\n' +
        '       ORDER BY c.updated_at DESC\n' +
        '       LIMIT $1',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content history retrieved by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: { queryText: 'DELETE FROM content', duration: 2, rows: 1 }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'INSERT INTO content (content, updated_by) VALUES ($1, $2)',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'SELECT c.id, c.content, c.updated_at, a.email \n' +
        '       FROM content c\n' +
        '       LEFT JOIN admins a ON c.updated_by = a.id\n' +
        '       ORDER BY c.updated_at DESC\n' +
        '       LIMIT $1',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content history retrieved by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: {
      queryText: 'SELECT c.id, c.content, c.updated_at, a.email \n' +
        '       FROM content c\n' +
        '       LEFT JOIN admins a ON c.updated_by = a.id\n' +
        '       ORDER BY c.updated_at DESC\n' +
        '       LIMIT $1',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content history retrieved by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: {
      queryText: 'SELECT c.id, c.content, c.updated_at, a.email \n' +
        '       FROM content c\n' +
        '       LEFT JOIN admins a ON c.updated_by = a.id\n' +
        '       ORDER BY c.updated_at DESC\n' +
        '       LIMIT $1',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content history retrieved by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: {
      queryText: 'SELECT c.id, c.content, c.updated_at, a.email \n' +
        '       FROM content c\n' +
        '       LEFT JOIN admins a ON c.updated_by = a.id\n' +
        '       ORDER BY c.updated_at DESC\n' +
        '       LIMIT $1',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Content history retrieved by: content-test@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: {
      queryText: 'DELETE FROM content WHERE updated_by = $1',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: { queryText: 'DELETE FROM admins WHERE id = $1', duration: 2, rows: 1 }

      at log (src/config/db.js:36:13)

PASS src/tests/content.controller.test.js
  Content Management API
    GET /content - Retrieval
      Ã”ÃªÃœ should return 200 and content object (21 ms)
      Ã”ÃªÃœ should return 401 without JWT (4 ms)
      Ã”ÃªÃœ should return 401 with invalid JWT (2 ms)
      Ã”ÃªÃœ should initialize empty content if none exists (11 ms)
      Ã”ÃªÃœ should return JSONB content correctly (10 ms)
    PUT /content - Full Update
      Ã”ÃªÃœ should update content and return 200 (18 ms)
      Ã”ÃªÃœ should set updated_by to authenticated admin (9 ms)
      Ã”ÃªÃœ should update updated_at timestamp (32 ms)
      Ã”ÃªÃœ should validate content data (must be object) (18 ms)
      Ã”ÃªÃœ should reject without JWT (3 ms)
      Ã”ÃªÃœ should accept empty object (13 ms)
    PATCH /content - Partial Update
      Ã”ÃªÃœ should merge partial data with existing content (14 ms)
      Ã”ÃªÃœ should not overwrite missing fields (13 ms)
      Ã”ÃªÃœ should return 401 without JWT (2 ms)
      Ã”ÃªÃœ should validate data schema (7 ms)
    GET /content/history - Content History
      Ã”ÃªÃœ should return array of content versions (6 ms)
      Ã”ÃªÃœ should include id, content, updated_at, email (10 ms)
      Ã”ÃªÃœ should respect limit parameter (5 ms)
      Ã”ÃªÃœ should default to 20 items if no limit (4 ms)
      Ã”ÃªÃœ should be ordered by updated_at DESC (4 ms)
      Ã”ÃªÃœ should return 401 without JWT (3 ms)

Test Suites: 1 passed, 1 total
Tests:       21 passed, 21 total
Snapshots:   0 total
Time:        0.702 s, estimated 2 s
Ran all test suites matching content.controller.test.js.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
