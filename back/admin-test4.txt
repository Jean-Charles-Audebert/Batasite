
> back@1.0.0 test
> jest --forceExit admin.controller.test.js

  console.log
    [dotenv@17.2.3] injecting env (16) from .env -- tip: ­ƒöä add secrets lifecycle management: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: ­ƒöæ add access controls to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Database config: {
      user: 'batadmin',
      host: 'localhost',
      port: 5434,
      database: 'batasite'
    }

      at Object.log (src/config/db.js:12:9)

  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: ÔÜÖ´©Å  specify custom .env file path with { path: '/custom/path/.env' }

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Query executed: {
      queryText: 'SELECT id FROM admins WHERE email = $1',
      duration: 22,
      rows: 0
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'INSERT INTO admins (email, password_hash, role) VALUES ($1, $2, $3) RETURNING id, email, role, is_active, created_at',
      duration: 5,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Admin created: {
      id: 70,
      email: 'admin-1765275729977@example.com',
      role: 'admin',
      is_active: true,
      created_at: 2025-12-09T09:22:10.054Z
    }

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: {
      queryText: 'SELECT id, email, password_hash, role, is_active FROM admins WHERE email = $1',
      duration: 1,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Admin logged in: admin-1765275729977@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    Query executed: {
      queryText: 'SELECT id FROM admins WHERE email = $1',
      duration: 2,
      rows: 0
    }

      at log (src/config/db.js:36:13)

  console.log
    Query executed: {
      queryText: 'INSERT INTO admins (email, password_hash, role) VALUES ($1, $2, $3) RETURNING id, email, role, is_active, created_at',
      duration: 2,
      rows: 1
    }

      at log (src/config/db.js:36:13)

  console.log
    [INFO] Admin created: {
      id: 71,
      email: 'test-admin-1765275730090@example.com',
      role: 'admin',
      is_active: true,
      created_at: 2025-12-09T09:22:10.114Z
    }

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Admin list retrieved by: admin-1765275729977@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Admin list retrieved by: admin-1765275729977@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Admin list retrieved by: admin-1765275729977@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Admin 71 retrieved by: admin-1765275729977@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Admin 71 retrieved by: admin-1765275729977@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Admin list retrieved by: admin-1765275729977@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

  console.log
    [INFO] Admin 70 activity retrieved by: admin-1765275729977@example.com

      at Object.log [as info] (src/utils/logger.js:6:13)

PASS src/tests/admin.controller.test.js
  Admin Management API
    GET /admin - List all admins
      ÔêÜ should return array of admins (200) (7 ms)
      ÔêÜ should return id, email, role, is_active (no password) (6 ms)
      ÔêÜ should return 401 without JWT (3 ms)
      ÔêÜ should return 401 with invalid JWT (2 ms)
      ÔêÜ should filter by role if query param provided (4 ms)
    GET /admin/:id - Fetch single admin
      ÔêÜ should return admin by ID (200) (5 ms)
      ÔêÜ should return id, email, role, is_active (no password) (5 ms)
      ÔêÜ should return 404 for non-existent admin (4 ms)
      ÔêÜ should return 400 for invalid admin ID format (3 ms)
      ÔêÜ should return 401 without JWT (3 ms)
    GET /admin/:id/activity - Fetch admin activity
      ÔêÜ should return activity log for admin (8 ms)
      ÔêÜ should return 401 without JWT (2 ms)
      ÔêÜ should return 404 for non-existent admin (4 ms)

Test Suites: 1 passed, 1 total
Tests:       13 passed, 13 total
Snapshots:   0 total
Time:        0.841 s, estimated 1 s
Ran all test suites matching admin.controller.test.js.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
